"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _DialogWindow=require("./DialogWindow"),_DialogWindow2=_interopRequireDefault(_DialogWindow),_vue=require("vue"),_vue2=_interopRequireDefault(_vue),_utils=require("../common/utils"),_utils2=_interopRequireDefault(_utils);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var createDialogWindow=function(e,o){var i=new(_vue2.default.component(_DialogWindow2.default.name,_DialogWindow2.default));i.$props.content=e,_utils2.default.isObjectNotNull(o)||(o={});var a=void 0;_utils2.default.isString(o.containerId)&&(a=document.getElementById(o.containerId)),a=a||document.body,i.$contianer=a;var t=!0===o.closeContentModalRestPart;return i.$props.closeContentModalRestPart=t,i.$mount(),a.appendChild(i.$el),i.$data.dialogBoxContentArgs=o.dialogBoxContentArgs,i.$data.visible=!0,i.$data.isRealClose=!1,i},availableDialogWindows={},Dialog={reuseMode:{get reuse(){return"ReUse"},get none(){return"None"}},showNonAwait:function(e,o){_utils2.default.isObjectNotNull(o)||(o={});var i=o.reuseMode;if(i===this.reuseMode.none&&!e)throw new Error("[Dialog]dialogContent为空");var a=void 0,t=Object.keys(availableDialogWindows).length;if(i===this.reuseMode.none||t<1){if(!e)throw new Error("[Dialog]dialogContent为空");(a=createDialogWindow(e,o)).$on("doRealClose",function(){a.$data.isRealClose=!0,Dialog.close(a)});var l=_utils2.default.uuidv4();return a.$uuid=l,availableDialogWindows[l]=a,a}if(i!==this.reuseMode.none&&t>1)throw new Error("[Dialog]对话框窗口多于一个");return a=availableDialogWindows[Object.keys(availableDialogWindows)[0]],e&&(a.$props.content=e),a.$data.dialogBoxContentArgs=o.dialogBoxContentArgs,a.$props.closeContentModalRestPart=!!o.closeContentModalRestPart,a},showAwait:function(e,o){var i=createDialogWindow(e,o);return new Promise(function(e){i.$on("doRealClose",function(o){i.$data.isRealClose=!0,Dialog.close(i),e(o)})})},getAvailableDialog:function(e){if(!e)throw new Error("[Dialog]getAvailableDialog:对话框标识符为空");if(!_utils2.default.isString(e))throw new Error("[Dialog]getAvailableDialog:对话框标识符不是字符串");return availableDialogWindows[e]},close:function(e){if(!e)throw new Error("[Dialog]close:对话框标识符为空");var o=void 0;if(o=_utils2.default.isString(e)?availableDialogWindows[e]:e.$parent||e)if(o.$data.isRealClose)o.$destroy(),o.$contianer.removeChild(o.$el);else{var i=o.$uuid;i&&delete availableDialogWindows[i],o.onClose(),o.$data.visible=!1}}};exports.default=Dialog;