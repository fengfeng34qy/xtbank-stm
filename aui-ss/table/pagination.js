"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Pager=require("./Pager"),_Pager2=_interopRequireDefault(_Pager),_Select=require("./Select"),_Select2=_interopRequireDefault(_Select),_settings=require("./common/settings/settings.js"),_settings2=_interopRequireDefault(_settings);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.default={name:"aui-pagination",props:{layout:{type:Array,default:function(){return["total","prev","pager","next","sizer","jumper"]}},size:{type:String},total:{type:Number,require:!0},pageIndex:{type:Number},showPagingCount:{type:Number,default:5},pageSize:{type:Number,default:10},pageSizeOption:{type:Array,default:function(){return[10,20,30]}}},data:function(){return{newPageIndex:this.pageIndex&&this.pageIndex>0?parseInt(this.pageIndex):1,newPageSize:this.pageSize,newPageSizeOption:[]}},computed:{pageCount:function(){return Math.ceil(this.total/this.newPageSize)}},render:function(e){var t=e("ul",{class:"v-page-ul"},[]),n={total:e("total",null,[]),prev:e("prev",null,[]),pager:e("pager",{attrs:{pageCount:this.pageCount,pageIndex:this.newPageIndex,showPagingCount:this.showPagingCount},on:{jumpPageHandler:this.jumpPageHandler}},[]),next:e("next",null,[]),sizer:e("sizer",null,[]),jumper:e("jumper",{on:{jumpPageHandler:this.jumpPageHandler}},[])};this.layout.forEach(function(e){t.children.push(n[e])});var a=_settings2.default.sizeMaps[this.size]||_settings2.default.sizeMapDefault,i=a===_settings2.default.sizeMaps.large?" v-page--large":a===_settings2.default.sizeMaps.middle?" v-page--middle":" v-page--small";return t.data.class+=i,t},components:{Total:{render:function(e){return e("span",{class:"v-page-total"},[" 共 ",this.$parent.total," 条 "])}},Prev:{render:function(e){return e("li",{on:{click:this.$parent.prevPage},class:[1===this.$parent.newPageIndex?"v-page-disabled":"","v-page-li","v-page-prev"]},[e("a",null,[e("i",{class:"aui-icon-angle-left"},[])])])}},pager:_Pager2.default,Next:{render:function(e){return e("li",{on:{click:this.$parent.nextPage},class:[this.$parent.newPageIndex===this.$parent.pageCount?"v-page-disabled":"","v-page-li","v-page-next"]},[e("a",null,[e("i",{class:"aui-icon-angle-right"},[])])])}},Sizer:{components:{AuiTableSelect:_Select2.default},render:function(e){return e("aui-table-select",{attrs:{size:this.$parent.size,value:this.$parent.newPageSizeOption},class:"v-page-select",on:{input:this.handleChange},directives:[{name:"model",value:this.$parent.newPageSizeOption}]},[])},methods:{handleChange:function(e){if(Array.isArray(e)&&e.length>0){var t=e.find(function(e){return e.selected});t&&this.$parent.pageSizeChangeHandler(t.value)}}},created:function(){}},Jumper:{methods:{jumperEnter:function(e){if(13===e.keyCode){var t=this.$parent.getValidNum(e.target.value);this.$parent.newPageIndex=t,this.$emit("jumpPageHandler",t)}}},render:function(e){return e("span",{class:"v-page-goto"},[" 前往 ",e("input",{class:"v-page-goto-input",domProps:{value:this.$parent.newPageIndex},on:{keyup:this.jumperEnter},attrs:{type:"input"}},[])," 页 "])}}},methods:{getValidNum:function(e){return e=parseInt(e,10),isNaN(e)||e<1?1:e<1?1:e>this.pageCount?this.pageCount:e},jumpPageHandler:function(e){this.newPageIndex=e,this.$emit("page-change",this.newPageIndex)},prevPage:function(){this.newPageIndex>1&&(this.newPageIndex=this.newPageIndex-1,this.$emit("page-change",this.newPageIndex))},nextPage:function(){this.newPageIndex<this.pageCount&&(this.newPageIndex=this.newPageIndex+1,this.$emit("page-change",this.newPageIndex))},pageSizeChangeHandler:function(){var e=this.newPageSizeOption.find(function(e){return e.selected});e&&(this.newPageSize=e.value,this.newPageIndex=1,this.$emit("page-size-change",this.newPageSize))},initSelectOption:function(){var e=this;this.newPageSizeOption=this.pageSizeOption.map(function(t){var n={};return n.value=t,n.label=t+" 条/页",e.newPageSize==t&&(n.selected=!0),n})},goBackPageIndex:function(){this.newPageIndex=this.pageIndex&&this.pageIndex>0?parseInt(this.pageIndex):1},goBackPageSize:function(){this.pageSize>0&&(this.newPageSize=this.pageSize,this.initSelectOption())}},watch:{pageIndex:function(e,t){this.newPageIndex=e},pageSize:function(e,t){this.newPageSize=e,this.initSelectOption()}},created:function(){this.initSelectOption()}};